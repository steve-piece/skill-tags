# AGENTS.md

## Project Overview

**skill-tags** is a CLI tool that generates Cursor command files from installed agent skills, enabling `@skill-name.md` references in chat for deterministic skill context injection.

## Repository Structure

```
skill-tags/
  bin/
    skill-tags.js     ← Node.js CLI entry point (spawns sync.sh)
    postinstall.js    ← Runs on npm install -g, triggers initial sync
  sync.sh             ← Core bash script: scans all skill sources, generates command files
  install.sh          ← Curl-pipeable one-line installer
  uninstall.sh        ← Removes script, shell wrapper, and generated command files
  package.json        ← npm package (name: skill-tags, bin: skill-tags)
  README.md
  LICENSE             ← MIT
```

## Key Conventions

- **Language:** bash (sync.sh, install.sh, uninstall.sh) + Node.js thin wrapper (bin/)
- **bash compatibility:** bash 3.2 (macOS default) — no associative arrays, no process substitution
- **Deduplication:** skill names tracked via colon-delimited string (`:name1:name2:`)
- **Priority order:** `~/.agents/skills` > `~/.cursor/skills-cursor` > `~/.cursor/plugins/cache` > `~/.claude/plugins/cache` > `~/.codex/skills` > `<cwd>/.agents/skills`
- **Output:** `~/.cursor/commands/<skill-name>.md` (global), `.cursor/commands/<skill-name>.md` (project)
- **Idempotent:** re-running always overwrites existing command files with latest skill content
- **Marker string:** `# ─── skill-tags / Cursor Skill Command Sync` identifies the shell wrapper block in rc files

## CLI Interface

```bash
skill-tags              # sync all sources
skill-tags --setup      # install skills() shell wrapper in ~/.zshrc
skill-tags --global-only  # skip project-level scan
skill-tags --version    # print version
skill-tags --help       # show usage
```

## Generated Command File Format

Each `~/.cursor/commands/<skill-name>.md`:

```markdown
# <skill-name>

<!-- Auto-generated by sync.sh (skill-tags) vX.X.X — do not edit manually -->

**Skill Location:** `~/.agents/skills/<skill-name>/`

## Files in This Skill
<directory listing>

---
<full SKILL.md contents>
```

## npm Package

- **Package name:** `skill-tags`
- **Binary:** `skill-tags`
- **Install:** `npm install -g skill-tags`
- **One-off:** `npx skill-tags`
- **postinstall** only runs on global installs (`npm_config_global=true`), never on project installs

## Shell Wrapper (auto-trigger)

Installed by `skill-tags --setup` or `install.sh`. Wraps `npx skills` in the user's shell rc:

```bash
function skills() {
  npx skills "$@"
  local exit_code=$?
  if [[ "$1" == "add" && $exit_code -eq 0 ]]; then
    bash ~/.cursor/sync-skill-commands.sh
  fi
  return $exit_code
}
```

## Version History

- `1.1.0` — Multi-source scan (plugin caches), deduplication, --setup/--version flags, npm package
- `1.0.0` — Initial release, global + cursor skills, curl installer
