# AGENTS.md

## Project Overview

**skill-tags** is a CLI tool that generates a consolidated Cursor command file from installed agent skills, enabling `@skill-tags.md` references in chat. This injects an index of all available skills into the context, instructing the agent to autonomously assess and apply the most relevant skills.

## Repository Structure

```
skill-tags/
  bin/
    skill-tags.js     ← Node.js CLI entry point (spawns sync.sh)
    postinstall.js    ← Runs on npm install -g, triggers initial sync
  sync.sh             ← Core bash script: scans all skill sources, generates the single command file
  install.sh          ← Curl-pipeable one-line installer
  uninstall.sh        ← Removes script, shell wrapper, and generated command files
  package.json        ← npm package (name: skill-tags, bin: skill-tags)
  README.md
  LICENSE             ← MIT
```

## Key Conventions

- **Language:** bash (sync.sh, install.sh, uninstall.sh) + Node.js thin wrapper (bin/)
- **bash compatibility:** bash 3.2 (macOS default) — no associative arrays, no process substitution
- **Deduplication:** skill names tracked via colon-delimited string (`:name1:name2:`)
- **Priority order:** `~/.agents/skills` > `~/.cursor/skills-cursor` > `~/.cursor/plugins/cache` > `~/.claude/plugins/cache` > `~/.codex/skills` > `<cwd>/.agents/skills`
- **Output:** A single `~/.cursor/commands/skill-tags.md` file listing all discovered skills.
- **Idempotent:** re-running always overwrites the existing command file with the latest skill index.
- **Marker string:** `# ─── skill-tags / Cursor Skill Command Sync` identifies the shell wrapper block in rc files

## CLI Interface

```bash
skill-tags              # sync all sources, generate skill-tags.md (+ category files if configured)
skill-tags --categories # interactive CRUD wizard to create/edit/delete category indexes
skill-tags --setup      # install skills() shell wrapper in ~/.zshrc
skill-tags --global-only  # skip project-level scan
skill-tags --version    # print version
skill-tags --help       # show usage
```

## Generated Command File Format

The `~/.cursor/commands/skill-tags.md` file:

```markdown
# Skill Tags Command

<!-- Auto-generated by sync.sh (skill-tags) vX.X.X — do not edit manually -->

[Agent instructions including Read tool requirement and Plan Mode guidance]

## Available Skills

### {Skill Title}
`~/.agents/skills/{skill-name}`

{Description extracted from YAML frontmatter}
...
```

Category files (`~/.cursor/commands/skills-<category>.md`) are written when `~/.cursor/skill-tags-categories.conf` exists. Each contains only the skills assigned to that category plus the same agent instructions.

## Key Conventions

- **Categorization — Tier 1:** `metadata.tags` in SKILL.md frontmatter (official skills.sh spec field)
- **Categorization — Tier 2:** Keyword match against skill name and description (fallback for skills without tags)
- **Category config:** `~/.cursor/skill-tags-categories.conf` — plain `key=value` format, bash 3.2 compatible
- **SKILLS_META_DIR:** Temp directory populated during every scan; holds one pipe-delimited file per skill (`display_path|description|tags`); used by `generate_category_files` and `cmd_categories`

## npm Package

- **Package name:** `skill-tags`
- **Binary:** `skill-tags`
- **Install:** `npm install -g skill-tags`
- **One-off:** `npx skill-tags`
- **postinstall** only runs on global installs (`npm_config_global=true`), never on project installs

## Shell Wrapper (auto-trigger)

Installed by `skill-tags --setup` or `install.sh`. Wraps `npx skills` in the user's shell rc:

```bash
function skills() {
  npx skills "$@"
  local exit_code=$?
  if [[ "$1" == "add" || "$1" == "remove" ]] && [[ $exit_code -eq 0 ]]; then
    bash ~/.cursor/sync-skill-commands.sh
  fi
  return $exit_code
}
```

## Version History

- `1.1.0` — Consolidated single file architecture (`skill-tags.md`), `--categories` wizard with two-tier auto-categorization (`metadata.tags` + keyword fallback), explicit Read tool agent hook, Plan Mode instructions.
- `1.0.0` — Initial release, global + cursor skills, individual `@skill-name.md` files.
